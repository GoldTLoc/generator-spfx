{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"PnP SPFx Yeoman generator This Yeoman generator provides improved governance for SharePoint Framework projects. It extends the out of the box Yeoman generator from Microsoft (@microsoft/generator-sharepoint) with recommended patterns and additional capabilities. For an optimized development workflow, it extends the capabilities for ReactJS, and Knockout projects and support for additional frameworks, such as HandlebarsJS, VueJS and Angular Elements. It also includes includes advanced code analysis and testing tools, which you can take advantage in you development work. All projects generated by this generator are 100% compliant with the out-of-the-box Yeoman generator from Microsoft. After the creation of a new solution, you can use either this generator or @microsoft/generator-sharepoint to add additional assets to your solution. SPFx Generator Version Base Generator @microsoft/generator-sharepoint 1.7.1 Features This generator supports a variaty of of frameworks and features such as: VueJS Handlebars Angular Elements Addons such as JEST, StyleLint or WebPack Bundel analyser More on that in the features section . Installation via NPM npm install -g @pnp/generator-spfx via YARN yarn global add @pnp/generator-spfx via PNPM pnpm install -g @pnp/generator-spfx For Evaluation and Testing This generator can be also tested via npx and the following command: npx -p yo -p @pnp/generator-spfx yo @pnp/spfx It will create a new project without installation of the generator. To add other assets the same command line can be executed again on the project folder. Start a new project To start a new project execute the following command: yo @pnp/spfx This will start the PnP SPFx Yeoman generator for a new project that gives you all the options to choose from. Watch it in action Command line options The following options provide a complete list of available switches. Usage: yo @pnp/spfx [ options ] Options: -h, --help # Print the generator s options and usage --skip-cache # Do not remember prompt answers - Default: false --skip-install # Do not automatically install dependencies - Default: false --force-install # Fail on install dependencies error - Default: false --component-description # Web part description --component-name # Web part name --component-type # The type of component: - webpart - extension --enviroment # The target environment for the solution: - onprem - onprem19 - spo --extension-type # The type of extension: - ApplicationCustomizer , - FieldCustomizer - ListViewCommandSet -pm, --package-manager # Let you choose the package manager: - npm - yarn - pnpm --plusbeta # Use the beta packages --skip-feature-deployment # If specified, allow the tenant admin the choice of being able to deploy the components to all sites immediately without running any feature deployment or adding apps in sites --solution-name # Solution name, as well as folder name Further information General project setup and folders Known Issues","title":"Home"},{"location":"#pnp-spfx-yeoman-generator","text":"This Yeoman generator provides improved governance for SharePoint Framework projects. It extends the out of the box Yeoman generator from Microsoft (@microsoft/generator-sharepoint) with recommended patterns and additional capabilities. For an optimized development workflow, it extends the capabilities for ReactJS, and Knockout projects and support for additional frameworks, such as HandlebarsJS, VueJS and Angular Elements. It also includes includes advanced code analysis and testing tools, which you can take advantage in you development work. All projects generated by this generator are 100% compliant with the out-of-the-box Yeoman generator from Microsoft. After the creation of a new solution, you can use either this generator or @microsoft/generator-sharepoint to add additional assets to your solution.","title":"PnP SPFx Yeoman generator"},{"location":"#spfx-generator-version","text":"Base Generator @microsoft/generator-sharepoint 1.7.1","title":"SPFx Generator Version"},{"location":"#features","text":"This generator supports a variaty of of frameworks and features such as: VueJS Handlebars Angular Elements Addons such as JEST, StyleLint or WebPack Bundel analyser More on that in the features section .","title":"Features"},{"location":"#installation","text":"","title":"Installation"},{"location":"#via-npm","text":"npm install -g @pnp/generator-spfx","title":"via NPM"},{"location":"#via-yarn","text":"yarn global add @pnp/generator-spfx","title":"via YARN"},{"location":"#via-pnpm","text":"pnpm install -g @pnp/generator-spfx","title":"via PNPM"},{"location":"#for-evaluation-and-testing","text":"This generator can be also tested via npx and the following command: npx -p yo -p @pnp/generator-spfx yo @pnp/spfx It will create a new project without installation of the generator. To add other assets the same command line can be executed again on the project folder.","title":"For Evaluation and Testing"},{"location":"#start-a-new-project","text":"To start a new project execute the following command: yo @pnp/spfx This will start the PnP SPFx Yeoman generator for a new project that gives you all the options to choose from.","title":"Start a new project"},{"location":"#watch-it-in-action","text":"","title":"Watch it in action"},{"location":"#command-line-options","text":"The following options provide a complete list of available switches. Usage: yo @pnp/spfx [ options ] Options: -h, --help # Print the generator s options and usage --skip-cache # Do not remember prompt answers - Default: false --skip-install # Do not automatically install dependencies - Default: false --force-install # Fail on install dependencies error - Default: false --component-description # Web part description --component-name # Web part name --component-type # The type of component: - webpart - extension --enviroment # The target environment for the solution: - onprem - onprem19 - spo --extension-type # The type of extension: - ApplicationCustomizer , - FieldCustomizer - ListViewCommandSet -pm, --package-manager # Let you choose the package manager: - npm - yarn - pnpm --plusbeta # Use the beta packages --skip-feature-deployment # If specified, allow the tenant admin the choice of being able to deploy the components to all sites immediately without running any feature deployment or adding apps in sites --solution-name # Solution name, as well as folder name","title":"Command line options"},{"location":"#further-information","text":"General project setup and folders Known Issues","title":"Further information"},{"location":"about/","text":"About @pnp/generator-spfx This Yeoman generator provides improved governance for SharePoint Framework projects. It extends the out of the box Yeoman generator from Microsoft (@microsoft/generator-sharepoint) with recommended patterns and additional capabilities. For an optimized development workflow, it extends the capabilities for ReactJS, and Knockout projects and support for additional frameworks, such as HandlebarsJS, VueJS and Angular Elements. It also includes includes advanced code analysis and testing tools, which you can take advantage in you development work. All projects generated by this generator are 100% compliant with the out-of-the-box Yeoman generator from Microsoft. After the creation of a new solution, you can use either this generator or @microsoft/generator-sharepoint to add additional assets to your solution.","title":"About"},{"location":"about/#about-pnpgenerator-spfx","text":"This Yeoman generator provides improved governance for SharePoint Framework projects. It extends the out of the box Yeoman generator from Microsoft (@microsoft/generator-sharepoint) with recommended patterns and additional capabilities. For an optimized development workflow, it extends the capabilities for ReactJS, and Knockout projects and support for additional frameworks, such as HandlebarsJS, VueJS and Angular Elements. It also includes includes advanced code analysis and testing tools, which you can take advantage in you development work. All projects generated by this generator are 100% compliant with the out-of-the-box Yeoman generator from Microsoft. After the creation of a new solution, you can use either this generator or @microsoft/generator-sharepoint to add additional assets to your solution.","title":"About @pnp/generator-spfx"},{"location":"contribution-guidelines/","text":"Contribution Guidelines There are not many contribution guidelines yet. If, however, you are not currently familiar with Yeoman generator development you will find some helpful links. Basic technologies to know Write your own Yeoman generator - This article provides you with basic insights on how to write a custom Yeoman generator Mocha getting started - To test that the Yeoman generator is working properly a testing framework named Mocha is used Embedded JavaScript templating - EJS is the core engine used in Yeoman to deploy template files and dynamically embed custom settings in the files getting deployed Places to look for help The JavaScript a Yeoman generator uses is based on Node.js and many things are treated differently than in the JavaScript that exists in browsers. Yeoman API Documentation - Besides the getting started guide, there is official documentation available that covers the complete Yeoman API Node.js documentation - In general, a Yeoman generator is written in JavaScript but it is based on Node.js where the development patterns are slightly different. In some cases it might be handy to consult the Node.js documentation.","title":"Contribution Guidelines"},{"location":"contribution-guidelines/#contribution-guidelines","text":"There are not many contribution guidelines yet. If, however, you are not currently familiar with Yeoman generator development you will find some helpful links.","title":"Contribution Guidelines"},{"location":"contribution-guidelines/#basic-technologies-to-know","text":"Write your own Yeoman generator - This article provides you with basic insights on how to write a custom Yeoman generator Mocha getting started - To test that the Yeoman generator is working properly a testing framework named Mocha is used Embedded JavaScript templating - EJS is the core engine used in Yeoman to deploy template files and dynamically embed custom settings in the files getting deployed","title":"Basic technologies to know"},{"location":"contribution-guidelines/#places-to-look-for-help","text":"The JavaScript a Yeoman generator uses is based on Node.js and many things are treated differently than in the JavaScript that exists in browsers. Yeoman API Documentation - Besides the getting started guide, there is official documentation available that covers the complete Yeoman API Node.js documentation - In general, a Yeoman generator is written in JavaScript but it is based on Node.js where the development patterns are slightly different. In some cases it might be handy to consult the Node.js documentation.","title":"Places to look for help"},{"location":"faq/","text":"Frequently asked questions Why can't I use TypeScript? TypeScript requires compilation to JavaScript. This results in more complexity and less support from the Yeoman community. To keep it plain and simple - only Node.js will be used at the moment. What is the difference between NodeJS and JavaScript? Node.js is an open-source, cross-platform JavaScript run-time environment that executes JavaScript code outside of a browser. It is used to develop backend services, shell scripts, development tools, and many more things. Node.js supports most of the features of the ECMA Script / JavaScript specification. All browsers run JavaScript, but do not always support the latest features of the ECMA Script Specification Do I need to install @microsoft/generator-sharepoint? No - The PnP SPFx generator has a dependency on a specific version of @microsoft/generator-sharepoint. This version will be automatically installed with the npm package of this generator. Can I have different versions of @microsoft/generator-sharepoint installed? Yes, you can, for example, have version 1.4.1 installed manually on your machine. When you run yo @microsoft/sharepoint this version will be used. However, when you run yo @pnp/spfx the version the community generator was built on will be used. For example, version 1.7 instead.","title":"FAQ"},{"location":"faq/#frequently-asked-questions","text":"","title":"Frequently asked questions"},{"location":"faq/#why-cant-i-use-typescript","text":"TypeScript requires compilation to JavaScript. This results in more complexity and less support from the Yeoman community. To keep it plain and simple - only Node.js will be used at the moment.","title":"Why can't I use TypeScript?"},{"location":"faq/#what-is-the-difference-between-nodejs-and-javascript","text":"Node.js is an open-source, cross-platform JavaScript run-time environment that executes JavaScript code outside of a browser. It is used to develop backend services, shell scripts, development tools, and many more things. Node.js supports most of the features of the ECMA Script / JavaScript specification. All browsers run JavaScript, but do not always support the latest features of the ECMA Script Specification","title":"What is the difference between NodeJS and JavaScript?"},{"location":"faq/#do-i-need-to-install-microsoftgenerator-sharepoint","text":"No - The PnP SPFx generator has a dependency on a specific version of @microsoft/generator-sharepoint. This version will be automatically installed with the npm package of this generator.","title":"Do I need to install @microsoft/generator-sharepoint?"},{"location":"faq/#can-i-have-different-versions-of-microsoftgenerator-sharepoint-installed","text":"Yes, you can, for example, have version 1.4.1 installed manually on your machine. When you run yo @microsoft/sharepoint this version will be used. However, when you run yo @pnp/spfx the version the community generator was built on will be used. For example, version 1.7 instead.","title":"Can I have different versions of @microsoft/generator-sharepoint installed?"},{"location":"features/","text":"Feature overview The official SPFx generator targets for three specific platforms: SharePoint Online SharePoint Online and SharePoint 2019 SharePoint Online, SharePoint 2019, SharePoint 2016 Not all those options generate the same version of SPFx projects and the available features are limited to the lowest supported version. Depending on the selections mad different options can be supported by the SharePoint Framework. SharePoint Online This options create a project based on the latest SPFx version 1.7.1 Addons jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 \u2705 \u2705 KnockoutJS \u2705 \u2705 \u2705 No Framework \u2705 \u2705 \u2705 VueJS \u2705 \u2705 \u2705 HandlebarsJS \u2705 \u2705 \u2705 Angular Elements \u2705 \u2705 \u2705 Vetting Options WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 VueJS \u2705 HandlebarsJS \u2705 \u2705 Angular Elements \u2705 \u2705 Test Framework Jest ReactJS \u2705 KnockoutJS No Framework \u2705 VueJS HandlebarsJS Angular Elements SharePoint Online and SharePoint 2019 This option creates a project based on SPFx version 1.4.0 Addons jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 \u2705 \u2705 KnockoutJS \u2705 \u2705 \u2705 No Framework \u2705 \u2705 \u2705 VueJS \u2705 \u2705 \u2705 HandlebarsJS \u2705 \u2705 \u2705 Angular Elements \u2705 \u2705 \u2705 Vetting Options WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 VueJS \u2705 HandlebarsJS \u2705 \u2705 Angular Elements \u2705 \u2705 Test Framework Jest ReactJS \u2705 KnockoutJS No Framework \u2705 VueJS HandlebarsJS Angular Elements SharePoint Online, SharePoint 2019, SharePoint 2016 This option creates a project based on SPFx version 1.1.0. This old version makes avoid to securly use the following frameworks: VueJS HandlebarsJS Angular Elements Addons jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 Vetting Options WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 Test Framework Jest ReactJS \u2705 KnockoutJS No Framework \u2705","title":"Feature Overview"},{"location":"features/#feature-overview","text":"The official SPFx generator targets for three specific platforms: SharePoint Online SharePoint Online and SharePoint 2019 SharePoint Online, SharePoint 2019, SharePoint 2016 Not all those options generate the same version of SPFx projects and the available features are limited to the lowest supported version. Depending on the selections mad different options can be supported by the SharePoint Framework.","title":"Feature overview"},{"location":"features/#sharepoint-online","text":"This options create a project based on the latest SPFx version 1.7.1","title":"SharePoint Online"},{"location":"features/#addons","text":"jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 \u2705 \u2705 KnockoutJS \u2705 \u2705 \u2705 No Framework \u2705 \u2705 \u2705 VueJS \u2705 \u2705 \u2705 HandlebarsJS \u2705 \u2705 \u2705 Angular Elements \u2705 \u2705 \u2705","title":"Addons"},{"location":"features/#vetting-options","text":"WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 VueJS \u2705 HandlebarsJS \u2705 \u2705 Angular Elements \u2705 \u2705","title":"Vetting Options"},{"location":"features/#test-framework","text":"Jest ReactJS \u2705 KnockoutJS No Framework \u2705 VueJS HandlebarsJS Angular Elements","title":"Test Framework"},{"location":"features/#sharepoint-online-and-sharepoint-2019","text":"This option creates a project based on SPFx version 1.4.0","title":"SharePoint Online and SharePoint 2019"},{"location":"features/#addons_1","text":"jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 \u2705 \u2705 KnockoutJS \u2705 \u2705 \u2705 No Framework \u2705 \u2705 \u2705 VueJS \u2705 \u2705 \u2705 HandlebarsJS \u2705 \u2705 \u2705 Angular Elements \u2705 \u2705 \u2705","title":"Addons"},{"location":"features/#vetting-options_1","text":"WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705 VueJS \u2705 HandlebarsJS \u2705 \u2705 Angular Elements \u2705 \u2705","title":"Vetting Options"},{"location":"features/#test-framework_1","text":"Jest ReactJS \u2705 KnockoutJS No Framework \u2705 VueJS HandlebarsJS Angular Elements","title":"Test Framework"},{"location":"features/#sharepoint-online-sharepoint-2019-sharepoint-2016","text":"This option creates a project based on SPFx version 1.1.0. This old version makes avoid to securly use the following frameworks: VueJS HandlebarsJS Angular Elements","title":"SharePoint Online, SharePoint 2019, SharePoint 2016"},{"location":"features/#addons_2","text":"jQuery pnp/pnpjs PnP Property Controls PnP Reusable Controls ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705","title":"Addons"},{"location":"features/#vetting-options_2","text":"WebPack Bundle Analyzer StyleLint ReactJS \u2705 \u2705 KnockoutJS \u2705 \u2705 No Framework \u2705 \u2705","title":"Vetting Options"},{"location":"features/#test-framework_2","text":"Jest ReactJS \u2705 KnockoutJS No Framework \u2705","title":"Test Framework"},{"location":"known-issues/","text":"Known Issues Version 1.6.2 When no library and no vetting option get selected 'gulp-sequence' is missing and has to be installed manually using npm install gulp-sequence --save-dev . #158 Version 1.4.0 Problem with 'ng serve' in application created by Angular Elements generator Currently there is an issue with web components polyfill in Angular Elements generator that causes errors when running application using ng serve command. Details on current state and workaround #113 Problem with Handlebars and create folder is selected during SPFx generator Currently there is an issue when the 'create folder for solution' option is selected in the questions of the @microsoft/sharepoint generator. Details on current state #84 If you find one please submit the issue to our GitHub Repository .","title":"Known Issues"},{"location":"known-issues/#known-issues","text":"","title":"Known Issues"},{"location":"known-issues/#version-162","text":"When no library and no vetting option get selected 'gulp-sequence' is missing and has to be installed manually using npm install gulp-sequence --save-dev . #158","title":"Version 1.6.2"},{"location":"known-issues/#version-140","text":"","title":"Version 1.4.0"},{"location":"known-issues/#problem-with-ng-serve-in-application-created-by-angular-elements-generator","text":"Currently there is an issue with web components polyfill in Angular Elements generator that causes errors when running application using ng serve command. Details on current state and workaround #113","title":"Problem with 'ng serve' in application created by Angular Elements generator"},{"location":"known-issues/#problem-with-handlebars-and-create-folder-is-selected-during-spfx-generator","text":"Currently there is an issue when the 'create folder for solution' option is selected in the questions of the @microsoft/sharepoint generator. Details on current state #84 If you find one please submit the issue to our GitHub Repository .","title":"Problem with Handlebars and create folder is selected during SPFx generator"},{"location":"license/","text":"MIT License Copyright (c) 2018 PnP Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"License"},{"location":"release-notes/","text":"Release Notes 1.6.2 Update of the project creation process Only supported options are available now #154 Feature Matrix in documentation updated Bugfix #150 Includes: - pnp/pnpjs - v1.2.9 - @pnp/spfx-property-controls - v1.14.0 - @pnp/@pnp/spfx-controls-react : v1.11.0 1.6.1 - 'gulp dist', Jest for no framework project Jest testing framework support for 'No Framework' projects New \"gulp dist\" task for faster-creating builds for production ('clean', 'bundle', 'package-solution') Update package versions on VueJS, HandlbarsJS generator Includes: pnp/pnpjs: v1.2.7 @pnp/spfx-property-controls: v1.14.0 @pnp/spfx-controls-react: v1.11.0 Bugfix #147 1.6.0 - Support for Jest, Webpack Bundle Analyser and StyleLint All generator can have support: WebPack Bundle Analyser StyleLint pnp/pnpjs 1.2.8 ReactJS supports: JEST testing support 1.5.0 - Upgrade to version @microsoft/generator-spfx 1.7.0 Upgrade to @microsoft/sharepoint version 1.7 by Pawel Hawrylak Update Test definition for onprem19 - Application Customizer and Web Parts Updated for On-Premises Support SharePoint 2019 Added additional SharePoint 2019 tests domain isolation option added package update checker added 1.4.3 - Handlebarjs Gulp updated Optimisation of Handlbar gulp task behaviour 1.4.2 - Angular Elements - Browser optimisation Polyfill and browser behaviour optimisation 1.4.1 - Angular Element - Bugfix Update on polyfill handling in various browsers 1.4.0 - Angular Generator added New Framework added: Angular Elements Other updates Update Handlebar dependencies Version dependencies update for Addons generator Small fixes for Angular Elements generator Update Handlebar dependencies Version dependencies update for Addons generator Fix Kebab Case naming convention Fixed bug with project name in Angular Elements generator (#107) Update Maintainer email address Added guide for Angular Elements Update package-lock.json Update pnpsays.js 1.3.1 - Version 1.3.1 - Minor bugfix in VueJS generator Bug fixed described in issue #98 1.3.0 - Integration of Office CLI for Version Check and Test Bench update Integration of Office CLI 365 for automated version check Implementation of new the test engine New Core Test Definition, Test Runner and Test Bench implemented Bugfix: Improvement file handling in gulp file Bugfix: #95 - Cannot find @microsoft/generator-sharepoint 1.2 - VueJS added New generator for VueJs - thanks to Alex Terentiev Structural generator change: All components are stored in the folder components . Bugfix for folder creation during project creation #84 Updates on utility class 1.1 - Reusable controls added Integration of Reusable React Controls for SharePoint Solutions Integration of Reusable Property Pane Controls for SharePoint Solutions 1.0 - Initial release First generator release Yeoman generator for Handlebars","title":"Release Notes"},{"location":"release-notes/#release-notes","text":"","title":"Release Notes"},{"location":"release-notes/#162-update-of-the-project-creation-process","text":"Only supported options are available now #154 Feature Matrix in documentation updated Bugfix #150 Includes: - pnp/pnpjs - v1.2.9 - @pnp/spfx-property-controls - v1.14.0 - @pnp/@pnp/spfx-controls-react : v1.11.0","title":"1.6.2 Update of the project creation process"},{"location":"release-notes/#161-gulp-dist-jest-for-no-framework-project","text":"Jest testing framework support for 'No Framework' projects New \"gulp dist\" task for faster-creating builds for production ('clean', 'bundle', 'package-solution') Update package versions on VueJS, HandlbarsJS generator Includes: pnp/pnpjs: v1.2.7 @pnp/spfx-property-controls: v1.14.0 @pnp/spfx-controls-react: v1.11.0 Bugfix #147","title":"1.6.1 - 'gulp dist', Jest for no framework project"},{"location":"release-notes/#160-support-for-jest-webpack-bundle-analyser-and-stylelint","text":"All generator can have support: WebPack Bundle Analyser StyleLint pnp/pnpjs 1.2.8 ReactJS supports: JEST testing support","title":"1.6.0 - Support for Jest, Webpack Bundle Analyser and StyleLint"},{"location":"release-notes/#150-upgrade-to-version-microsoftgenerator-spfx-170","text":"Upgrade to @microsoft/sharepoint version 1.7 by Pawel Hawrylak Update Test definition for onprem19 - Application Customizer and Web Parts Updated for On-Premises Support SharePoint 2019 Added additional SharePoint 2019 tests domain isolation option added package update checker added","title":"1.5.0 - Upgrade to version @microsoft/generator-spfx 1.7.0"},{"location":"release-notes/#143-handlebarjs-gulp-updated","text":"Optimisation of Handlbar gulp task behaviour","title":"1.4.3 - Handlebarjs Gulp updated"},{"location":"release-notes/#142-angular-elements-browser-optimisation","text":"Polyfill and browser behaviour optimisation","title":"1.4.2 - Angular Elements - Browser optimisation"},{"location":"release-notes/#141-angular-element-bugfix","text":"Update on polyfill handling in various browsers","title":"1.4.1 - Angular Element - Bugfix"},{"location":"release-notes/#140-angular-generator-added","text":"New Framework added: Angular Elements Other updates Update Handlebar dependencies Version dependencies update for Addons generator Small fixes for Angular Elements generator Update Handlebar dependencies Version dependencies update for Addons generator Fix Kebab Case naming convention Fixed bug with project name in Angular Elements generator (#107) Update Maintainer email address Added guide for Angular Elements Update package-lock.json Update pnpsays.js","title":"1.4.0 - Angular Generator added"},{"location":"release-notes/#131-version-131-minor-bugfix-in-vuejs-generator","text":"Bug fixed described in issue #98","title":"1.3.1 - Version 1.3.1 - Minor bugfix in VueJS generator"},{"location":"release-notes/#130-integration-of-office-cli-for-version-check-and-test-bench-update","text":"Integration of Office CLI 365 for automated version check Implementation of new the test engine New Core Test Definition, Test Runner and Test Bench implemented Bugfix: Improvement file handling in gulp file Bugfix: #95 - Cannot find @microsoft/generator-sharepoint","title":"1.3.0 - Integration of Office CLI for Version Check and Test Bench update"},{"location":"release-notes/#12-vuejs-added","text":"New generator for VueJs - thanks to Alex Terentiev Structural generator change: All components are stored in the folder components . Bugfix for folder creation during project creation #84 Updates on utility class","title":"1.2 - VueJS added"},{"location":"release-notes/#11-reusable-controls-added","text":"Integration of Reusable React Controls for SharePoint Solutions Integration of Reusable Property Pane Controls for SharePoint Solutions","title":"1.1 - Reusable controls added"},{"location":"release-notes/#10-initial-release","text":"First generator release Yeoman generator for Handlebars","title":"1.0 - Initial release"},{"location":"compose/","text":"Composing custom SPFx generators PnP SPFx Generator - Development Before you start development of a custom yeoman generator, please be sure to read Writing your own Yeoman Generator . The following sections explain the overall setup and considerations. Project Setup The following directory listing gives you an overview of the main directories in the generator: \u251c\u2500\u2500 app -- Main Generator \u251c\u2500\u2500 docs -- Documentation \u251c\u2500\u2500 generators -- Custom Generators \u2502 \u251c\u2500\u2500 addons -- Addon Generator reserved for client libraries only \u2502 \u251c\u2500\u2500 handlebars -- PnP Handlebars generator \u251c\u2500\u2500 lib -- General purpose libraries \u251c\u2500\u2500 test -- Mocha Unit Tests \u251c\u2500\u2500 tools \u2502 \u251c\u2500\u2500 generator-template -- Template yeoman generator Getting started writing a new generator To get started implementing and adding a new generator, copy the template folder in the generators folder and rename it to a meaningful name matching your framework. In the folder you will find the following files: index.js - main sub generator file promptconfig.js - special prompt config related to sub generator template/addonConfig.json - This file contains all NPM Packages that need to be installed User prompt for sub generator If your generator needs some additional information from the user, questions can be configured in the file promptconfig.js . The content of this file follows the default Yeoman generator user prompting described in the article Interacting with the User . The library Yeoman uses is Inquirer.js . use strict // These are just sample selection of options const options = [{ name : Option A , value : option-a }, { name : Option B , value : option-b } ]; const configOptions = [ // Sample content of questions { type : list , message : Please add your options in here , name : youroptions , choices : options } // , addon ] const promptConfig = { config : configOptions } module . exports = promptConfig ; This example exports the configuration as a module and can be integrated in the main Yeoman generator to consolidate the user prompts in the main generator. Generator implementation - index.js All actions required for a new custom generator need to be implemented in the index.js file. The default template currently lists all possible methods in the correct call order provided by the default Yeoman generator: // Base Yeoman generator const Generator = require ( yeoman-generator ); // prompt configuration const prompts = require ( ./promptConfig ); module . exports = class extends Generator { constructor ( args , opts ) { super ( args , opts ); // configuration of user prompt } // Initialisation geenerator initializing () { } // Prompt for user input for Custom Generator prompting () { } // adds additonal editor support in this case CSS Comb configuring () { // Currently not supported - Don t use this } // adds additonal editor support in this case CSS Comb writing () { // Currently not supported - Don t use this } // adds additonal editor support in this case CSS Comb install () { /** * Place your custom deployment code in here */ } // Run installer normally time to say goodbye // If yarn is installed yarn will be used end () { } } The call order of a Yeoman generator is defined in the following steps: constructor() initializing() prompting() configuring() writing() install() end() Because of the dependency on the Microsoft Yeoman Generator, the actions need to be delayed to the next step. After the SPFx generator has written the files to the file system through its writing() method, the custom generator is able to update the configuration with additional information. Instead of adding the code of the custom generator to the writing() method, the code has to be added to the install() method. In the case of the Handlebars generator, the following functions get called in the install() method: install () { // deploy additional files to the project directory this . _deployFiles (); // add externals to the configuration this . _addExternals (); // add all package depenedencies configured in addonConfig.json. this . _addPackageDependencies (); // inject custom tasks to gulpfile this . _injectToGulpFile (); // finally run install util . runInstall ( this ); } This is required because all additional tasks have to be performed on top of the assets deployed by the SPFx default assets. Further reading: How to implement prompting","title":"General"},{"location":"compose/#composing-custom-spfx-generators","text":"","title":"Composing custom SPFx generators"},{"location":"compose/#pnp-spfx-generator-development","text":"Before you start development of a custom yeoman generator, please be sure to read Writing your own Yeoman Generator . The following sections explain the overall setup and considerations.","title":"PnP SPFx Generator - Development"},{"location":"compose/#project-setup","text":"The following directory listing gives you an overview of the main directories in the generator: \u251c\u2500\u2500 app -- Main Generator \u251c\u2500\u2500 docs -- Documentation \u251c\u2500\u2500 generators -- Custom Generators \u2502 \u251c\u2500\u2500 addons -- Addon Generator reserved for client libraries only \u2502 \u251c\u2500\u2500 handlebars -- PnP Handlebars generator \u251c\u2500\u2500 lib -- General purpose libraries \u251c\u2500\u2500 test -- Mocha Unit Tests \u251c\u2500\u2500 tools \u2502 \u251c\u2500\u2500 generator-template -- Template yeoman generator","title":"Project Setup"},{"location":"compose/#getting-started-writing-a-new-generator","text":"To get started implementing and adding a new generator, copy the template folder in the generators folder and rename it to a meaningful name matching your framework. In the folder you will find the following files: index.js - main sub generator file promptconfig.js - special prompt config related to sub generator template/addonConfig.json - This file contains all NPM Packages that need to be installed","title":"Getting started writing a new generator"},{"location":"compose/#user-prompt-for-sub-generator","text":"If your generator needs some additional information from the user, questions can be configured in the file promptconfig.js . The content of this file follows the default Yeoman generator user prompting described in the article Interacting with the User . The library Yeoman uses is Inquirer.js . use strict // These are just sample selection of options const options = [{ name : Option A , value : option-a }, { name : Option B , value : option-b } ]; const configOptions = [ // Sample content of questions { type : list , message : Please add your options in here , name : youroptions , choices : options } // , addon ] const promptConfig = { config : configOptions } module . exports = promptConfig ; This example exports the configuration as a module and can be integrated in the main Yeoman generator to consolidate the user prompts in the main generator.","title":"User prompt for sub generator"},{"location":"compose/#generator-implementation-indexjs","text":"All actions required for a new custom generator need to be implemented in the index.js file. The default template currently lists all possible methods in the correct call order provided by the default Yeoman generator: // Base Yeoman generator const Generator = require ( yeoman-generator ); // prompt configuration const prompts = require ( ./promptConfig ); module . exports = class extends Generator { constructor ( args , opts ) { super ( args , opts ); // configuration of user prompt } // Initialisation geenerator initializing () { } // Prompt for user input for Custom Generator prompting () { } // adds additonal editor support in this case CSS Comb configuring () { // Currently not supported - Don t use this } // adds additonal editor support in this case CSS Comb writing () { // Currently not supported - Don t use this } // adds additonal editor support in this case CSS Comb install () { /** * Place your custom deployment code in here */ } // Run installer normally time to say goodbye // If yarn is installed yarn will be used end () { } } The call order of a Yeoman generator is defined in the following steps: constructor() initializing() prompting() configuring() writing() install() end() Because of the dependency on the Microsoft Yeoman Generator, the actions need to be delayed to the next step. After the SPFx generator has written the files to the file system through its writing() method, the custom generator is able to update the configuration with additional information. Instead of adding the code of the custom generator to the writing() method, the code has to be added to the install() method. In the case of the Handlebars generator, the following functions get called in the install() method: install () { // deploy additional files to the project directory this . _deployFiles (); // add externals to the configuration this . _addExternals (); // add all package depenedencies configured in addonConfig.json. this . _addPackageDependencies (); // inject custom tasks to gulpfile this . _injectToGulpFile (); // finally run install util . runInstall ( this ); } This is required because all additional tasks have to be performed on top of the assets deployed by the SPFx default assets. Further reading: How to implement prompting","title":"Generator implementation - index.js"},{"location":"compose/add-addons/","text":"Add custom Addon dependencies Applies to: generators/addons If you would just like to integrate custom client-side dependencies, there is no need to write your own generator. This can just be included directly in the addon generator. Add npm dependencies The dependency configuration of additional addons is located in generators/addons/templates and is named addonConfig.json. In this JSON file you can include additional configurations for various NPM packages. { jquery@2 : { dependencies : { jquery : ^2.2.4 , @types/jquery : ^2.0.49 } }, jquery@3 : { dependencies : { jquery : ^3.0.0 , @types/jquery : ^3.0.0 } }, pnpjs : { dependencies : { @pnp/pnpjs : ^1.1.1 } } } To add a custom library add a new property in the form of: yourcustomlibrary@2 : { // custom library name @ major version label dependencies : { // dependencies or devDependencies firstdependency : ^1.0.0 , // library named first dependecy, @types/firstdependency : ^1.0.0 , // types for first dependecy // .. any additional library } } The updated addonConfiguration.json file then might look like this: { jquery@2 : { dependencies : { jquery : ^2.2.4 , @types/jquery : ^2.0.49 } }, jquery@3 : { dependencies : { jquery : ^3.0.0 , @types/jquery : ^3.0.0 } }, pnpjs : { dependencies : { @pnp/pnpjs : ^1.1.1 } }, yourcustomlibrary@2 : { dependencies : { firstdependency : ^1.0.0 , @types/firstdependency : ^1.0.0 } } } DO NOT use comments in JSON files - This causes the files to be invalid Integrate the new library in prompting To ask the user to include this new library open the promptConfig.js file in the addon generator. In the config options add a reference to the new library: ... const configOptions = [ // Library selection { type : checkbox , message : Which libraries to include , name : jsLibrary , choices : [{ name : jQuery , value : jquery }, { name : pnpjs , value : @pnp/pnpjs }, // New reference { name : New awesome library to include , value : yourcustomlibrary@2 } ] }, // jQuery version selection { type : list , message : ` ${ chalk . bold . yellow ( jQuery: ) } Please choose a version:` , name : jQueryVersion , choices : jqueryOptions , when : answers = answers . jsLibrary . indexOf ( jquery ) !== - 1 } ] module . exports = configOptions ; The name of the new reference can be set to any descriptive text but the value must match the property name used in the addonConfig.json . The selection of this dialog gets picked up automatically during the provisioning process and will be added to the package.json option. The same method can be used to inject dependencies on custom generators too.","title":"Dependencies for addons"},{"location":"compose/add-addons/#add-custom-addon-dependencies","text":"Applies to: generators/addons If you would just like to integrate custom client-side dependencies, there is no need to write your own generator. This can just be included directly in the addon generator.","title":"Add custom Addon dependencies"},{"location":"compose/add-addons/#add-npm-dependencies","text":"The dependency configuration of additional addons is located in generators/addons/templates and is named addonConfig.json. In this JSON file you can include additional configurations for various NPM packages. { jquery@2 : { dependencies : { jquery : ^2.2.4 , @types/jquery : ^2.0.49 } }, jquery@3 : { dependencies : { jquery : ^3.0.0 , @types/jquery : ^3.0.0 } }, pnpjs : { dependencies : { @pnp/pnpjs : ^1.1.1 } } } To add a custom library add a new property in the form of: yourcustomlibrary@2 : { // custom library name @ major version label dependencies : { // dependencies or devDependencies firstdependency : ^1.0.0 , // library named first dependecy, @types/firstdependency : ^1.0.0 , // types for first dependecy // .. any additional library } } The updated addonConfiguration.json file then might look like this: { jquery@2 : { dependencies : { jquery : ^2.2.4 , @types/jquery : ^2.0.49 } }, jquery@3 : { dependencies : { jquery : ^3.0.0 , @types/jquery : ^3.0.0 } }, pnpjs : { dependencies : { @pnp/pnpjs : ^1.1.1 } }, yourcustomlibrary@2 : { dependencies : { firstdependency : ^1.0.0 , @types/firstdependency : ^1.0.0 } } } DO NOT use comments in JSON files - This causes the files to be invalid","title":"Add npm dependencies"},{"location":"compose/add-addons/#integrate-the-new-library-in-prompting","text":"To ask the user to include this new library open the promptConfig.js file in the addon generator. In the config options add a reference to the new library: ... const configOptions = [ // Library selection { type : checkbox , message : Which libraries to include , name : jsLibrary , choices : [{ name : jQuery , value : jquery }, { name : pnpjs , value : @pnp/pnpjs }, // New reference { name : New awesome library to include , value : yourcustomlibrary@2 } ] }, // jQuery version selection { type : list , message : ` ${ chalk . bold . yellow ( jQuery: ) } Please choose a version:` , name : jQueryVersion , choices : jqueryOptions , when : answers = answers . jsLibrary . indexOf ( jquery ) !== - 1 } ] module . exports = configOptions ; The name of the new reference can be set to any descriptive text but the value must match the property name used in the addonConfig.json . The selection of this dialog gets picked up automatically during the provisioning process and will be added to the package.json option. The same method can be used to inject dependencies on custom generators too.","title":"Integrate the new library in prompting"},{"location":"compose/add-generator/","text":"Step-by-Step Custom generator This sample provides a ste","title":"Step-by-Step Custom generator"},{"location":"compose/add-generator/#step-by-step-custom-generator","text":"This sample provides a ste","title":"Step-by-Step Custom generator"},{"location":"compose/custgen-dependencies/","text":"Inject dependencies using your custom generator It is possible to inject dependencies into the generated project using your custom generator. The sub generator for Handlebars, for example, does this. A config file for all required npm packages to include can be found in this generator: { handlebars : { dependencies : { handlebars : ^4.0.6 }, devDependencies : { handlebars-template-loader : ^1.0.0 , @types/handlebars : ^4.0.39 } } } The addonConfig.json in the handlebar generator contains all required dependencies. Those npm packages that are required during runtime and those required during development. To inject those dependecies to the generated package.json , call the following method in your generator code. _addPackageDependencies () { if ( fs . existsSync ( this . destinationPath ( package.json ))) { // request the default package file let config ; try { config = JSON . parse ( fs . readFileSync ( this . destinationPath ( package.json ) )); } catch ( error ) { throw error ; } // request current addon configuration let addonConfig ; try { addonConfig = JSON . parse ( fs . readFileSync ( this . templatePath ( addonConfig.json ) ) ) } catch ( err ) { throw err ; } // select the requested libraries let requestedLibraries = [ handlebars ]; // declare new package config file let newPkgConfig ; try { newPkgConfig = util . mergeAddons ( addonConfig , requestedLibraries , config ); } catch ( error ) { throw error } // if content could be added to the new package.json write it if ( newPkgConfig !== undefined newPkgConfig !== null ) { fs . writeFileSync ( this . destinationPath ( package.json ), JSON . stringify ( newPkgConfig , null , 2 ) ); } else { throw Updated package.json file is invalid. ; } } } For the requested libraries parameter, pass in an array of identifiers stored in your addon configuration. In the case of the handlebar generator this is just 'handlebars': let requestedLibraries = [ handlebars ]; You can have multiple identifiers in this array. Remark It is possible to inject additional dependencies by calling npm install from the generator directly. In case of multiple runs there may be delays and conflicts for the injection and is even slower than adding it directly in the package.json files. How to include version numbers? Make sure you don't have a fixed number included in your package versions. Make sure you include '^' in front of the version number. This makes sure that the latest version in that version branch will be used. More on caret ranges can be found it the official npm documentation.","title":"Inject dependencies"},{"location":"compose/custgen-dependencies/#inject-dependencies-using-your-custom-generator","text":"It is possible to inject dependencies into the generated project using your custom generator. The sub generator for Handlebars, for example, does this. A config file for all required npm packages to include can be found in this generator: { handlebars : { dependencies : { handlebars : ^4.0.6 }, devDependencies : { handlebars-template-loader : ^1.0.0 , @types/handlebars : ^4.0.39 } } } The addonConfig.json in the handlebar generator contains all required dependencies. Those npm packages that are required during runtime and those required during development. To inject those dependecies to the generated package.json , call the following method in your generator code. _addPackageDependencies () { if ( fs . existsSync ( this . destinationPath ( package.json ))) { // request the default package file let config ; try { config = JSON . parse ( fs . readFileSync ( this . destinationPath ( package.json ) )); } catch ( error ) { throw error ; } // request current addon configuration let addonConfig ; try { addonConfig = JSON . parse ( fs . readFileSync ( this . templatePath ( addonConfig.json ) ) ) } catch ( err ) { throw err ; } // select the requested libraries let requestedLibraries = [ handlebars ]; // declare new package config file let newPkgConfig ; try { newPkgConfig = util . mergeAddons ( addonConfig , requestedLibraries , config ); } catch ( error ) { throw error } // if content could be added to the new package.json write it if ( newPkgConfig !== undefined newPkgConfig !== null ) { fs . writeFileSync ( this . destinationPath ( package.json ), JSON . stringify ( newPkgConfig , null , 2 ) ); } else { throw Updated package.json file is invalid. ; } } } For the requested libraries parameter, pass in an array of identifiers stored in your addon configuration. In the case of the handlebar generator this is just 'handlebars': let requestedLibraries = [ handlebars ]; You can have multiple identifiers in this array.","title":"Inject dependencies using your custom generator"},{"location":"compose/custgen-dependencies/#remark","text":"It is possible to inject additional dependencies by calling npm install from the generator directly. In case of multiple runs there may be delays and conflicts for the injection and is even slower than adding it directly in the package.json files. How to include version numbers? Make sure you don't have a fixed number included in your package versions. Make sure you include '^' in front of the version number. This makes sure that the latest version in that version branch will be used. More on caret ranges can be found it the official npm documentation.","title":"Remark"},{"location":"compose/prompting/","text":"How to implement prompting Yeoman generator use a library named Inquirer.js for the prompt configuration. To read more on the general prompting behaviour checkout Interacting with the User in the Yeoman documentation. To support multiple Yeoman generators with different prompting configurations, a special method was implemented in the core generators such as the addon generator. generators/addons \u251c\u2500\u2500 index.js \u251c\u2500\u2500 promptConfig.js # - this is the configuration file for the prompts \u2514\u2500\u2500 templates \u2514\u2500\u2500 addonConfig.json All prompts required by the generator are included in the prompt config file directly inside the Yeoman generator. const chalk = require ( chalk ); const jqueryOptions = [{ name : 3.x.x (recommended) , value : 3 }, { name : 2.x.x , value : 2 } ] const configOptions = [ // Library selection { type : checkbox , message : Which libraries to include , name : jsLibrary , choices : [{ name : jQuery , value : jquery }, { name : pnpjs , value : @pnp/pnpjs }] }, // jQuery version selection { type : list , message : ` ${ chalk . bold . yellow ( jQuery: ) } Please choose a version:` , name : jQueryVersion , choices : jqueryOptions , when : answers = answers . jsLibrary . indexOf ( jquery ) !== - 1 } ] module . exports = configOptions ; This example defines the questions for jQuery when used in the PnP SPFx generator and will be exported as a module in node. This is required because all configuration options will then be collected together in the main generator and is located in the /app folder. Inside this folder is another promptConfig and the particular configuration of the addon generator prompting gets imported. // Add configuration of Addon generator const addon = require ( ../generators/addons/promptConfig ); configOptions = configOptions . concat ( addon ); const promptConfig = { config : configOptions } module . exports = promptConfig ; This code imports the module of the addon configuraton and adds the settings to the default generator prompting. This config file will again be exported as a module and gets used in the main generator code. prompting () { /* DO NOT ENTER CODE HERE */ this . prompt ( prompting . config ) . then ( answers = { // Choose appro this . options . SpfxOptions [ framework ] = this . _evalSPFxGenerator ( answers . framework ); this . options . pnpFramework = answers . framework ; this . options . libraries = this . _evalAddons ( answers ); this . options . SPFxFramework = answers . framework ; this . _configGenerators ( this . options ); }); } So this makes sure that all prompt configurations can be centrally managed - even the ones specific to additional generators. Info If your custom generator has a special promting configuration, please add a comment in your Pull Request saying so","title":"Prompting"},{"location":"compose/prompting/#how-to-implement-prompting","text":"Yeoman generator use a library named Inquirer.js for the prompt configuration. To read more on the general prompting behaviour checkout Interacting with the User in the Yeoman documentation. To support multiple Yeoman generators with different prompting configurations, a special method was implemented in the core generators such as the addon generator. generators/addons \u251c\u2500\u2500 index.js \u251c\u2500\u2500 promptConfig.js # - this is the configuration file for the prompts \u2514\u2500\u2500 templates \u2514\u2500\u2500 addonConfig.json All prompts required by the generator are included in the prompt config file directly inside the Yeoman generator. const chalk = require ( chalk ); const jqueryOptions = [{ name : 3.x.x (recommended) , value : 3 }, { name : 2.x.x , value : 2 } ] const configOptions = [ // Library selection { type : checkbox , message : Which libraries to include , name : jsLibrary , choices : [{ name : jQuery , value : jquery }, { name : pnpjs , value : @pnp/pnpjs }] }, // jQuery version selection { type : list , message : ` ${ chalk . bold . yellow ( jQuery: ) } Please choose a version:` , name : jQueryVersion , choices : jqueryOptions , when : answers = answers . jsLibrary . indexOf ( jquery ) !== - 1 } ] module . exports = configOptions ; This example defines the questions for jQuery when used in the PnP SPFx generator and will be exported as a module in node. This is required because all configuration options will then be collected together in the main generator and is located in the /app folder. Inside this folder is another promptConfig and the particular configuration of the addon generator prompting gets imported. // Add configuration of Addon generator const addon = require ( ../generators/addons/promptConfig ); configOptions = configOptions . concat ( addon ); const promptConfig = { config : configOptions } module . exports = promptConfig ; This code imports the module of the addon configuraton and adds the settings to the default generator prompting. This config file will again be exported as a module and gets used in the main generator code. prompting () { /* DO NOT ENTER CODE HERE */ this . prompt ( prompting . config ) . then ( answers = { // Choose appro this . options . SpfxOptions [ framework ] = this . _evalSPFxGenerator ( answers . framework ); this . options . pnpFramework = answers . framework ; this . options . libraries = this . _evalAddons ( answers ); this . options . SPFxFramework = answers . framework ; this . _configGenerators ( this . options ); }); } So this makes sure that all prompt configurations can be centrally managed - even the ones specific to additional generators. Info If your custom generator has a special promting configuration, please add a comment in your Pull Request saying so","title":"How to implement prompting"},{"location":"howtos/","text":"How To This section contains all the important information about how to work with the projects generated by this Yeoman Generator. Angular Elements","title":"How Tos"},{"location":"howtos/#how-to","text":"This section contains all the important information about how to work with the projects generated by this Yeoman Generator. Angular Elements","title":"How To"},{"location":"howtos/angularelements/","text":"Angular Elements Prerequisites Before you can create new Angular Elements project you need to have @pnp/generator-spfx and @angular/cli packages installed globally. If you use npm, you can install them using following command in command prompt: npm install -g @pnp/generator-spfx @angular/cli Getting started To create new Angular Elements project: In your new project folder start SPFx PnP Generator using following command: yo @pnp/spfx Choose Angular Elements as framework in interactive prompt. Provide options for generator e.g. you can provide your own parameters to Angular CLI ng new command that is used to create new Angular project. Wait for creation of projects and installation of dependencies. Development Angular Elements generator creates separate SPFx and Angular projects. This allows you to use Angular CLI in development. SPFx project folder is created with -spfx suffix. Output generated from Angular is bundled and imported in SPFx Web Part. To build Angular project and bundle it in single file you should use npm run bundle command in Angular project folder. To build SPFx project, you can just use default gulp bundle --ship and gulp package-solution --ship commands in SPFx project folder. You can test your solution in SPFx Workbench using default gulp serve command in SPFx project folder or in Angular Dev Server using npm run start command in Angular project folder. Live Demo","title":"Angular Elements"},{"location":"howtos/angularelements/#angular-elements","text":"","title":"Angular Elements"},{"location":"howtos/angularelements/#prerequisites","text":"Before you can create new Angular Elements project you need to have @pnp/generator-spfx and @angular/cli packages installed globally. If you use npm, you can install them using following command in command prompt: npm install -g @pnp/generator-spfx @angular/cli","title":"Prerequisites"},{"location":"howtos/angularelements/#getting-started","text":"To create new Angular Elements project: In your new project folder start SPFx PnP Generator using following command: yo @pnp/spfx Choose Angular Elements as framework in interactive prompt. Provide options for generator e.g. you can provide your own parameters to Angular CLI ng new command that is used to create new Angular project. Wait for creation of projects and installation of dependencies.","title":"Getting started"},{"location":"howtos/angularelements/#development","text":"Angular Elements generator creates separate SPFx and Angular projects. This allows you to use Angular CLI in development. SPFx project folder is created with -spfx suffix. Output generated from Angular is bundled and imported in SPFx Web Part. To build Angular project and bundle it in single file you should use npm run bundle command in Angular project folder. To build SPFx project, you can just use default gulp bundle --ship and gulp package-solution --ship commands in SPFx project folder. You can test your solution in SPFx Workbench using default gulp serve command in SPFx project folder or in Angular Dev Server using npm run start command in Angular project folder.","title":"Development"},{"location":"howtos/angularelements/#live-demo","text":"","title":"Live Demo"},{"location":"howtos/handlebars/","text":"","title":"Handlebars"},{"location":"howtos/jquery/","text":"How to use jQuery","title":"How to use jQuery"},{"location":"howtos/jquery/#how-to-use-jquery","text":"","title":"How to use jQuery"},{"location":"howtos/test-coverage/","text":"SharePoint Online SPO Handlebars: WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet SPO Knockout: WebPart ApplicationCustomizer FieldCustomizer = N/A ListViewCommandSet SPO No Framework: WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet SPO ReactJS: WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet SPO VueJS WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet I hope all possible variants of: No Addon or jQuery 2.0 or jQuery 3.0 pnpjs React Property Pane Control","title":"SharePoint Online"},{"location":"howtos/test-coverage/#sharepoint-online","text":"","title":"SharePoint Online"},{"location":"howtos/test-coverage/#spo-handlebars","text":"WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet","title":"SPO Handlebars:"},{"location":"howtos/test-coverage/#spo-knockout","text":"WebPart ApplicationCustomizer FieldCustomizer = N/A ListViewCommandSet","title":"SPO Knockout:"},{"location":"howtos/test-coverage/#spo-no-framework","text":"WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet","title":"SPO No Framework:"},{"location":"howtos/test-coverage/#spo-reactjs","text":"WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet","title":"SPO ReactJS:"},{"location":"howtos/test-coverage/#spo-vuejs","text":"WebPart ApplicationCustomizer FieldCustomizer ListViewCommandSet","title":"SPO VueJS"},{"location":"howtos/test-coverage/#i-hope-all-possible-variants-of","text":"No Addon or jQuery 2.0 or jQuery 3.0 pnpjs React Property Pane Control","title":"I hope all possible variants of:"},{"location":"recipes/","text":"Recipies for Development In this section you will find useful code snippets and explanations. Yeoman Run install SPFx related Inject custom gulp configuration and tasks Deploy Web Part Content, Extensions and Customizer","title":"Recipies for Development"},{"location":"recipes/#recipies-for-development","text":"In this section you will find useful code snippets and explanations.","title":"Recipies for Development"},{"location":"recipes/#yeoman","text":"Run install","title":"Yeoman"},{"location":"recipes/#spfx-related","text":"Inject custom gulp configuration and tasks Deploy Web Part Content, Extensions and Customizer","title":"SPFx related"},{"location":"recipes/deploy-custom-code/","text":"Update provisioned artifacts for web parts, extensions and customizer with generator It is possible to inject code that directly references web parts and extensions. Right now this is only supported for SharePoint Online projects and not for on-premises. The tools folder provides templates to inject code directly in the web part, application customizer, command set, and/or field customizer. tools/spfx \u251c\u2500\u2500 applicationcustomizer-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 commandset-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 fieldcustomizer-spo \u2502 \u251c\u2500\u2500 { componentClassName } .module.scss \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u2514\u2500\u2500 webparts-spo \u251c\u2500\u2500 { componentClassName } .module.scss \u2514\u2500\u2500 { componentClassName } .ts These files will be maintained and updated with every new major release of the Microsoft SharePoint Framework generator. Copy these template files to your generator Copy the files located in the template folder to your custom generator in the template path. The overall setup of the generator should match the following pattern. generators/your-generator/ \u251c\u2500\u2500 index.js \u2514\u2500\u2500 templates \u251c\u2500\u2500 addonConfig.json \u251c\u2500\u2500 config \u2502 \u2514\u2500\u2500 copy-static-assets.json \u251c\u2500\u2500 gulpfile.js \u2514\u2500\u2500 spfx \u251c\u2500\u2500 applicationcustomizer-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 fieldcustomizer-spo \u2502 \u251c\u2500\u2500 { componentClassName } .module.scss \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 listviewcommandset-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u2514\u2500\u2500 webpart-spo \u251c\u2500\u2500 { componentClassName } .module.scss \u2514\u2500\u2500 { componentClassName } .ts Now modify the files to match your requirements. For example, the HandlebarsJS generator has the following lines of code added to the import statements when generating a web part: import { Version } from @microsoft/sp-core-library ; import { BaseClientSideWebPart , IPropertyPaneConfiguration , PropertyPaneTextField } from @microsoft/sp-webpart-base ; import { escape } from @microsoft/sp-lodash-subset ; import styles from ./ %= componentClassName % .module.scss ; import * as strings from %= componentStrings % ; import * as Handlebars from handlebars ; export interface I %= componentClassName % Props { description : string ; } export default class %= componentClassName % extends BaseClientSideWebPart I %= componentClassName % Props { ... The only code in this example that was added is the following line: import * as Handlebars from handlebars ; This make sure that after the provisioning of a web part, coding can start immediately. Deploy custom code in generator The files located in the SPFx folder serve as templates for all customizable assets. The names should not be changed because this will cause the whole deployment to break. To make sure the template gets deployed, a small utility needs to be called directly in the installation method of the Yeoman generator. Make sure you reference the utility class in your Yeoman generator code: // importing utilities const util = require ( ../../lib/util.js ); In the install method call the following utility method: install () { // # BUG currently only appears just in test util . deployTemplates ( this ); } This utility will detect which component got added during the regular SPFx runtime and adds the code directly to the file.","title":"Deploy Custom Code"},{"location":"recipes/deploy-custom-code/#update-provisioned-artifacts-for-web-parts-extensions-and-customizer-with-generator","text":"It is possible to inject code that directly references web parts and extensions. Right now this is only supported for SharePoint Online projects and not for on-premises. The tools folder provides templates to inject code directly in the web part, application customizer, command set, and/or field customizer. tools/spfx \u251c\u2500\u2500 applicationcustomizer-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 commandset-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 fieldcustomizer-spo \u2502 \u251c\u2500\u2500 { componentClassName } .module.scss \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u2514\u2500\u2500 webparts-spo \u251c\u2500\u2500 { componentClassName } .module.scss \u2514\u2500\u2500 { componentClassName } .ts These files will be maintained and updated with every new major release of the Microsoft SharePoint Framework generator.","title":"Update provisioned artifacts for web parts, extensions and customizer with generator"},{"location":"recipes/deploy-custom-code/#copy-these-template-files-to-your-generator","text":"Copy the files located in the template folder to your custom generator in the template path. The overall setup of the generator should match the following pattern. generators/your-generator/ \u251c\u2500\u2500 index.js \u2514\u2500\u2500 templates \u251c\u2500\u2500 addonConfig.json \u251c\u2500\u2500 config \u2502 \u2514\u2500\u2500 copy-static-assets.json \u251c\u2500\u2500 gulpfile.js \u2514\u2500\u2500 spfx \u251c\u2500\u2500 applicationcustomizer-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 fieldcustomizer-spo \u2502 \u251c\u2500\u2500 { componentClassName } .module.scss \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u251c\u2500\u2500 listviewcommandset-spo \u2502 \u2514\u2500\u2500 { componentClassName } .ts \u2514\u2500\u2500 webpart-spo \u251c\u2500\u2500 { componentClassName } .module.scss \u2514\u2500\u2500 { componentClassName } .ts Now modify the files to match your requirements. For example, the HandlebarsJS generator has the following lines of code added to the import statements when generating a web part: import { Version } from @microsoft/sp-core-library ; import { BaseClientSideWebPart , IPropertyPaneConfiguration , PropertyPaneTextField } from @microsoft/sp-webpart-base ; import { escape } from @microsoft/sp-lodash-subset ; import styles from ./ %= componentClassName % .module.scss ; import * as strings from %= componentStrings % ; import * as Handlebars from handlebars ; export interface I %= componentClassName % Props { description : string ; } export default class %= componentClassName % extends BaseClientSideWebPart I %= componentClassName % Props { ... The only code in this example that was added is the following line: import * as Handlebars from handlebars ; This make sure that after the provisioning of a web part, coding can start immediately.","title":"Copy these template files to your generator"},{"location":"recipes/deploy-custom-code/#deploy-custom-code-in-generator","text":"The files located in the SPFx folder serve as templates for all customizable assets. The names should not be changed because this will cause the whole deployment to break. To make sure the template gets deployed, a small utility needs to be called directly in the installation method of the Yeoman generator. Make sure you reference the utility class in your Yeoman generator code: // importing utilities const util = require ( ../../lib/util.js ); In the install method call the following utility method: install () { // # BUG currently only appears just in test util . deployTemplates ( this ); } This utility will detect which component got added during the regular SPFx runtime and adds the code directly to the file.","title":"Deploy custom code in generator"},{"location":"recipes/inject-gulp-tasks/","text":"Inject custom gulp task To inject a custom gulp task into a SharePoint Framework generated gulpfile.js , use the following method. Add a file named gulpfile.js in the templates folder of the custom generator. The following code sample shows the content taken from the Handlebars generator and registers the web pack loader along with a custom gulp watch: // definition of Handlebars loader const loaderConfig = { test : /\\.hbs/ , loader : handlebars-template-loader }; // Merge custom loader to web pack configuration build . configureWebpack . mergeConfig ({ additionalConfiguration : ( generatedConfiguration ) = { generatedConfiguration . module . rules . push ( loaderConfig ); return generatedConfiguration ; } }); // marker to check if custom watch is already registered // used to prevent watch bubbling let customWatchRegistered = false ; // Register watches sub task to move hbs files over to libs directory let hbsWatch = build . subTask ( hbsWatch , ( gulp , buildOptions , done ) = { // register watch only on first run if ( ! customWatchRegistered ) { // on change of *.hbs files gulp . watch ( ./src/**/*.hbs , event = { // copy hbs from src to lib gulp . src ( ./src/**/*.hbs ) . pipe ( gulp . dest ( ./lib/ )); // copy empty index.ts onto itself to launch build procees gulp . src ( ./src/index.ts ) . pipe ( gulp . dest ( ./src/ )); }); // after watch is registered don t register again customWatchRegistered = true ; } else { // make sure preBuild file will be copied once again gulp . src ( ./src/**/*.hbs ) . pipe ( gulp . dest ( ./lib/ )); } // tell build.rig the work is done. done (); }); build . rig . addPreBuildTask ( hbsWatch ); This file should only contain the required code that needs added to the SPFx owned gulpfile.js . Add the following code index.js after the end() method: _injectToGulpFile () { if ( fs . existsSync ( this . destinationPath ( gulpfile.js ))) { let coreGulpTemplate = this . templatePath ( ../../../app/templates/gulpfile.js ); let customGulpTemplate = this . templatePath ( ./gulpfile.js ) let mergedGulpFile = util . composeGulpFile ( coreGulpTemplate , customGulpTemplate ); fs . writeFileSync ( this . destinationPath ( ./gulpfile.js ), mergedGulpFile , utf-8 ); } } To execute the injection of your custom task in gulpfile.js , call this method from the install() method: install () { this . _injectToGulpFile (); } To verify, execute the yeoman generator and look up the changes within gulpfile.js in the project directory.","title":"Inject gulp tasks"},{"location":"recipes/inject-gulp-tasks/#inject-custom-gulp-task","text":"To inject a custom gulp task into a SharePoint Framework generated gulpfile.js , use the following method. Add a file named gulpfile.js in the templates folder of the custom generator. The following code sample shows the content taken from the Handlebars generator and registers the web pack loader along with a custom gulp watch: // definition of Handlebars loader const loaderConfig = { test : /\\.hbs/ , loader : handlebars-template-loader }; // Merge custom loader to web pack configuration build . configureWebpack . mergeConfig ({ additionalConfiguration : ( generatedConfiguration ) = { generatedConfiguration . module . rules . push ( loaderConfig ); return generatedConfiguration ; } }); // marker to check if custom watch is already registered // used to prevent watch bubbling let customWatchRegistered = false ; // Register watches sub task to move hbs files over to libs directory let hbsWatch = build . subTask ( hbsWatch , ( gulp , buildOptions , done ) = { // register watch only on first run if ( ! customWatchRegistered ) { // on change of *.hbs files gulp . watch ( ./src/**/*.hbs , event = { // copy hbs from src to lib gulp . src ( ./src/**/*.hbs ) . pipe ( gulp . dest ( ./lib/ )); // copy empty index.ts onto itself to launch build procees gulp . src ( ./src/index.ts ) . pipe ( gulp . dest ( ./src/ )); }); // after watch is registered don t register again customWatchRegistered = true ; } else { // make sure preBuild file will be copied once again gulp . src ( ./src/**/*.hbs ) . pipe ( gulp . dest ( ./lib/ )); } // tell build.rig the work is done. done (); }); build . rig . addPreBuildTask ( hbsWatch ); This file should only contain the required code that needs added to the SPFx owned gulpfile.js . Add the following code index.js after the end() method: _injectToGulpFile () { if ( fs . existsSync ( this . destinationPath ( gulpfile.js ))) { let coreGulpTemplate = this . templatePath ( ../../../app/templates/gulpfile.js ); let customGulpTemplate = this . templatePath ( ./gulpfile.js ) let mergedGulpFile = util . composeGulpFile ( coreGulpTemplate , customGulpTemplate ); fs . writeFileSync ( this . destinationPath ( ./gulpfile.js ), mergedGulpFile , utf-8 ); } } To execute the injection of your custom task in gulpfile.js , call this method from the install() method: install () { this . _injectToGulpFile (); } To verify, execute the yeoman generator and look up the changes within gulpfile.js in the project directory.","title":"Inject custom gulp task"},{"location":"recipes/run-install/","text":"Run install npm packages from generator After all required modifications have been applied to a new project by the Yeoman generator, the npm packages need to be installed. To provide a consistent method for all generators, a utility class was implemented that provides a single method to run the installer. Default behaviour of the installer Like the SPFx Default Yeoman generator installer, it supports the following three package managers: npm pnpm yarn Be default, the npm package manager will be used. If the yarn package manager is installed on the client, this package manager will instead be used by default. The pnpm package manager is available via a command line switch when the yeoman generator gets launched. To install dependencies with a specific package manager, the following options exist: To explicitly use npm: yo @pnp/spfx --pm npm or yo @pnp/spfx --package-manager npm To explicitly use pnpm: yo @pnp/spfx --pm pnpm or yo @pnp/spfx --package-manager pnpm To explicitly use pnpm: yo @pnp/spfx --pm yarn or yo @pnp/spfx --package-manager yarn Reference to the Util Your generators index.js should include the following line of code somewhere at the start: // importing utilities const util = require ( ../../lib/util.js ); Call npm package installation Add the following line of code in the install method of your generator: install (){ /* Custom configuration code should be placed before the installer */ util . runInstall ( this ); }","title":"Run Install"},{"location":"recipes/run-install/#run-install-npm-packages-from-generator","text":"After all required modifications have been applied to a new project by the Yeoman generator, the npm packages need to be installed. To provide a consistent method for all generators, a utility class was implemented that provides a single method to run the installer.","title":"Run install npm packages from generator"},{"location":"recipes/run-install/#default-behaviour-of-the-installer","text":"Like the SPFx Default Yeoman generator installer, it supports the following three package managers: npm pnpm yarn Be default, the npm package manager will be used. If the yarn package manager is installed on the client, this package manager will instead be used by default. The pnpm package manager is available via a command line switch when the yeoman generator gets launched. To install dependencies with a specific package manager, the following options exist: To explicitly use npm: yo @pnp/spfx --pm npm or yo @pnp/spfx --package-manager npm To explicitly use pnpm: yo @pnp/spfx --pm pnpm or yo @pnp/spfx --package-manager pnpm To explicitly use pnpm: yo @pnp/spfx --pm yarn or yo @pnp/spfx --package-manager yarn","title":"Default behaviour of the installer"},{"location":"recipes/run-install/#reference-to-the-util","text":"Your generators index.js should include the following line of code somewhere at the start: // importing utilities const util = require ( ../../lib/util.js );","title":"Reference to the Util"},{"location":"recipes/run-install/#call-npm-package-installation","text":"Add the following line of code in the install method of your generator: install (){ /* Custom configuration code should be placed before the installer */ util . runInstall ( this ); }","title":"Call npm package installation"},{"location":"tools/util/","text":"Util - Overview The util module can be found in the './lib/' directory and contains the following methods. mergeAddons(addonConfig, requestedLibraries, config) This method merges add-ons in package.json . addonConfig Configuration of add-ons available in the generator. requestedLibraries Array of requested library identifiers. config Given configuration to merge add-ons in the currently used package.json , for example. composeGulpFile(coreTemplate, customTemplate) This method allows you to inject custom gulp tasks in the gulp file. coreTemplate Path to any gulp file you would like to use as a template. customTemplate Contains all your custom gulp tasks you would like to inject. The core template in the generator provided by SPFx is located in the folder /app/templates/gulpfile.js and contains the following EJS code: use strict ; const gulp = require ( gulp ); const build = require ( @microsoft/sp-build-web ); build . addSuppression ( `Warning - [sass] The local CSS class ms-Grid is not camelCase and will not be type-safe.` ); %= customTasks % build . initialize ( gulp ); The custom generator can point to this file using the following code: let coreGulpTemplate = this . templatePath ( ../../../app/templates/gulpfile.js ); The following example shows a simple custom code snippet that should be included in the gulp file: // code to inject in gulp file console . log ( Hello PnP SPFx generator ); The resulting gulpfile.js after the merge in this case will be: use strict ; const gulp = require ( gulp ); const build = require ( @microsoft/sp-build-web ); build . addSuppression ( `Warning - [sass] The local CSS class ms-Grid is not camelCase and will not be type-safe.` ); // code to inject in gulp file console . log ( Hello PnP SPFx generator ); build . initialize ( gulp );","title":"Util - Overview"},{"location":"tools/util/#util-overview","text":"The util module can be found in the './lib/' directory and contains the following methods.","title":"Util - Overview"},{"location":"tools/util/#mergeaddonsaddonconfig-requestedlibraries-config","text":"This method merges add-ons in package.json . addonConfig Configuration of add-ons available in the generator. requestedLibraries Array of requested library identifiers. config Given configuration to merge add-ons in the currently used package.json , for example.","title":"mergeAddons(addonConfig, requestedLibraries, config)"},{"location":"tools/util/#composegulpfilecoretemplate-customtemplate","text":"This method allows you to inject custom gulp tasks in the gulp file. coreTemplate Path to any gulp file you would like to use as a template. customTemplate Contains all your custom gulp tasks you would like to inject. The core template in the generator provided by SPFx is located in the folder /app/templates/gulpfile.js and contains the following EJS code: use strict ; const gulp = require ( gulp ); const build = require ( @microsoft/sp-build-web ); build . addSuppression ( `Warning - [sass] The local CSS class ms-Grid is not camelCase and will not be type-safe.` ); %= customTasks % build . initialize ( gulp ); The custom generator can point to this file using the following code: let coreGulpTemplate = this . templatePath ( ../../../app/templates/gulpfile.js ); The following example shows a simple custom code snippet that should be included in the gulp file: // code to inject in gulp file console . log ( Hello PnP SPFx generator ); The resulting gulpfile.js after the merge in this case will be: use strict ; const gulp = require ( gulp ); const build = require ( @microsoft/sp-build-web ); build . addSuppression ( `Warning - [sass] The local CSS class ms-Grid is not camelCase and will not be type-safe.` ); // code to inject in gulp file console . log ( Hello PnP SPFx generator ); build . initialize ( gulp );","title":"composeGulpFile(coreTemplate, customTemplate)"}]}